var reports = "[{\"Student\":1,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":1,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":8},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":1,\"Cycle\":5,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Photography\",\"Grade\":7},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":5,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":7},{\"Student\":2,\"Cycle\":5,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Mandarin\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":\"\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Mandarin\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Latin\",\"Grade\":8},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":5,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Latin\",\"Grade\":7},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":5,\"Subject\":\"RS\",\"Grade\":\"-\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":1,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":6},{\"Student\":1,\"Cycle\":4,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Photography\",\"Grade\":8},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":4,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":6},{\"Student\":2,\"Cycle\":4,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Mandarin\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":3,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":8},{\"Student\":3,\"Cycle\":4,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":4,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":4,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":4,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":4,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Latin\",\"Grade\":8},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":4,\"Subject\":\"RS\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Drama\",\"Grade\":6},{\"Student\":1,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":5},{\"Student\":1,\"Cycle\":3,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Photography\",\"Grade\":8},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Computer Science\",\"Grade\":7},{\"Student\":2,\"Cycle\":3,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":6},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Geography\",\"Grade\":5},{\"Student\":2,\"Cycle\":3,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Mandarin\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":3,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":8},{\"Student\":3,\"Cycle\":3,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":3,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":4,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":3,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":3,\"Subject\":\"French\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":3,\"Subject\":\"RS\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":1,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":6},{\"Student\":1,\"Cycle\":2,\"Subject\":\"PE\",\"Grade\":8},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Photography\",\"Grade\":8},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":2,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":7},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":2,\"Cycle\":2,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Mandarin\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Drama\",\"Grade\":5},{\"Student\":3,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":8},{\"Student\":3,\"Cycle\":2,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":2,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Drama\",\"Grade\":6},{\"Student\":4,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":2,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":2,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":2,\"Subject\":\"RS\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":6},{\"Student\":1,\"Cycle\":1,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Photography\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":1,\"Subject\":\"DT\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":6},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":2,\"Cycle\":1,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Mandarin\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":3,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":7},{\"Student\":3,\"Cycle\":1,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":1,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":4,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":1,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":7},{\"Student\":5,\"Cycle\":1,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Latin\",\"Grade\":7},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":1,\"Subject\":\"RS\",\"Grade\":\"B\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Spanish\",\"Grade\":\"A*\"}]";

var cycles = "[{\"ID\":1,\"Name\":\"Mich 1\",\"Date\":\"20-Oct-17\"},{\"ID\":2,\"Name\":\"Mich 2\",\"Date\":\"01-Dec-17\"},{\"ID\":3,\"Name\":\"Lent 1\",\"Date\":\"20-Feb-18\"},{\"ID\":4,\"Name\":\"Lent 2\",\"Date\":\"01-Apr-18\"},{\"ID\":5,\"Name\":\"Summer 1\",\"Date\":\"01-May-18\"}]";

var baselines = "[{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Biology\",\"Baseline\":\"-\"},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Chemistry\",\"Baseline\":6.7},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Drama\",\"Baseline\":6.4},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"English\",\"Baseline\":6.3},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Geography\",\"Baseline\":6.4},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Maths\",\"Baseline\":6.6},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"PE\",\"Baseline\":6.2},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Photography\",\"Baseline\":6.4},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Physics\",\"Baseline\":6.7},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Spanish\",\"Baseline\":6.3},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Biology\",\"Baseline\":7.5},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Chemistry\",\"Baseline\":7.5},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Computer Science\",\"Baseline\":6.9},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"DT\",\"Baseline\":7.4},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"English\",\"Baseline\":7.5},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"History\",\"Baseline\":7.7},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Mandarin\",\"Baseline\":7.07},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Maths\",\"Baseline\":8},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Physics\",\"Baseline\":7.6},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Biology\",\"Baseline\":7},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Chemistry\",\"Baseline\":6.9},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Drama\",\"Baseline\":6.7},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"English\",\"Baseline\":6.6},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"History\",\"Baseline\":6.8},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Mandarin\",\"Baseline\":6.47},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Maths\",\"Baseline\":7},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"PE\",\"Baseline\":6.5},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Physics\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Biology\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Chemistry\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Drama\",\"Baseline\":6.7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"English\",\"Baseline\":6.7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Geography\",\"Baseline\":6.8},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Latin\",\"Baseline\":6.67},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Maths\",\"Baseline\":7.1},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"PE\",\"Baseline\":6.5},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Physics\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Spanish\",\"Baseline\":6.7},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Biology\",\"Baseline\":7.1},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Chemistry\",\"Baseline\":7.1},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"English\",\"Baseline\":6.9},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"French\",\"Baseline\":6.8},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"History\",\"Baseline\":7},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Latin\",\"Baseline\":6.77},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Maths\",\"Baseline\":7.3},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"RS\",\"Baseline\":7.1},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Physics\",\"Baseline\":6.9},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Spanish\",\"Baseline\":6.9}]";

var target_va = "0.6";
var yeargroup_average = "[{\"Cycle\":1,\"VA\":0.32},{\"Cycle\":2,\"VA\":0.41},{\"Cycle\":3,\"VA\":0.38},{\"Cycle\":4,\"VA\":0.45},{\"Cycle\":5,\"VA\":0.52}]";

/* Globals */
var session_user;
var teacher;

var active_cycle;
var current_view;
var active_student;

var student_average_order;
var student_subject_order;
var full_tutor_array;
var page_title;
var tracker_chart;
var tracker_options;

$(document).ready(function(){
    if(!checkLoggedInUser()) window.location = "login.html";
    session_user = JSON.parse(sessionStorage.getItem("user"));
    teacher = session_user["UserObject"];
    initPage();

    baselines = JSON.parse(baselines);
    cycles = JSON.parse(cycles);
    reports = JSON.parse(reports);
    yeargroup_average = JSON.parse(yeargroup_average);
    full_tutor_array = generateFullTutorArray(reports, cycles, baselines);
    cycles = orderArrayByDate(cycles, "Date", "DD-MMM-YY", false);
    page_title = "Murray 5th Form";
    student_average_order = ["Surname", false];
    student_subject_order = ["Subject", false];
    tracker_options = [["Tracker", true, "Tracker"], ["Target VA", false, "TargetVA"], ["Year Avg", false, "YearAvg"]];
    /* Set up view */
    active_cycle = cycles[cycles.length - 1]["ID"];
    current_view = "SUMMARY";
    active_student = null;

    /* setUpPage */
    setUpPage();
});

$(window).resize(function() {
    adjustTrackerSize();
});

function setUpPage() {
    hideAllViews();
    switch(current_view) {
        case "SUMMARY":
        default:
            showSummaryView();
            $("#main_title").html("<h1>" + page_title + "</h1>");
            writeCycleButtons();
            writeStudentAverageTable();
            break;
        case "TRACKER":
            showStudentTrackerView();
            $("#main_title").html("<h1>" + getStudentName(active_student) + "</h1>");
            tracker_options[0][0] = getStudentName(active_student);
            setUpStudentButtons();
            writeStudentTrackerOptions();
            writeStudentTracker();
            break;
        case "SUBJECTS":
            showStudentSubjectView();
            $("#main_title").html("<h1>" + getStudentName(active_student) + "</h1>");
            writeCycleButtons();
            setUpStudentButtons();
            writeStudentSubjectsTable();
            break;
    }
}

/* Show/hide all views */

function hideAllViews() {
    $("#cycle_buttons").css("display", "none");
    $("#student_average_table").css("display", "none");
    $("#student_tracker").css("display", "none");
    $("#student_tabs").css("display", "none");
    $("#student_subjects_table").css("display", "none");
    $("#top_buttons").css("display", "none");
}

function showSummaryView() {
    $("#cycle_buttons").css("display", "inline-block");
    $("#student_average_table").css("display", "inline-block");
    $(".primary_section").removeClass("orange");
    $(".primary_section").removeClass("tracker");
}

function showStudentTrackerView() {
    $("#student_tracker").css("display", "inline-block");
    $("#student_tabs").css("display", "inline-block");
    $(".primary_section").addClass("orange");
    $(".primary_section").addClass("tracker");
    $("#top_buttons").css("display", "inline-block");
    $("#student_tracker_button").addClass("active");
    $("#student_subjects_button").removeClass("active");
}

function showStudentSubjectView() {
    $("#student_tabs").css("display", "inline-block");
    $("#cycle_buttons").css("display", "inline-block");
    $("#student_subjects_table").css("display", "inline-block");
    $(".primary_section").addClass("orange");
    $(".primary_section").addClass("tracker");
    $("#top_buttons").css("display", "inline-block");
    $("#student_tracker_button").removeClass("active");
    $("#student_subjects_button").addClass("active");
}


function clickStudentTrackerButton() {
    current_view = "TRACKER";
    setUpPage();
}

function clickStudentSubjectsButton() {
    current_view = "SUBJECTS";
    setUpPage();
}

function changeStudent(student) {
    active_student = student;
    setUpPage();
}

function backToSummary() {
    current_view = "SUMMARY";
    setUpPage();
}

function writeCycleButtons() {
    var html_text = "";
    for (var i = 0; i < cycles.length; i++) {
        var title = cycles[i]["Name"];
        var id = cycles[i]["ID"];
        var class_text = "primary_section_button";
        if (id === active_cycle) class_text += " active";
        if (i === cycles.length - 1) class_text += " last";
        html_text += "<div class='" + class_text + "' id='cycle_button_" + id + "' onclick='clickCycleButton(" + id + ")'><h4>" + title + "</h4></div>";
    }
    $("#cycle_buttons").html(html_text);
}

function writeStudentAverageTable(students) {
    var table_array = [];
    var order_key = "Surname";
    var order_desc = true;
    if(student_average_order[0]) {
        order_key = student_average_order[0];
        order_desc = student_average_order[1];
    }
    /* Header row */
    var col_1 = order_key === "Surname" ? order_desc ? "Student &darr;" : "Student &uarr;" : "Student";
    var col_2 = order_key === "Baseline" ? order_desc ? "Baseline &darr;" : "Baseline &uarr;" : "Baseline";
    var col_3 = order_key === "Grade" ? order_desc ? "Grade &darr;" : "Grade &uarr;" : "Grade";
    var col_4 = order_key === "VA" ? order_desc ? "VA &darr;" : "VA &uarr;" : "VA";
    var html_text = "<div class='header_row row'><div class='fill_col col left' onclick=clickHeader(\'Surname\',0)><h3>" + col_1 + "</h3></div>";
    html_text += "<div class='fixed_col col' onclick=clickHeader(\'Baseline\',0)><h3>" + col_2 + "</h3></div>"
    html_text += "<div class='fixed_col col' onclick=clickHeader(\'Grade\',0)><h3>" + col_3 + "</h3></div>";
    html_text += "<div class='fixed_col col' onclick=clickHeader(\'VA\',0)><h3>" + col_4 + "</h3></div></div>";
    for (var i = 0; i < full_tutor_array.length; i++) {
        var id = full_tutor_array[i]["ID"];
        var name = full_tutor_array[i]["Name"] + " " + full_tutor_array[i]["Surname"];
        var baseline = full_tutor_array[i]["AvBaseline"];
        baseline = isNaN(parseFloat(baseline)) ? "-" : precisionRound(baseline, 1);
        var student_cycles = full_tutor_array[i]["Cycles"];
        var student_cycle = false;
        var grade = "-";
        var va = "-";
        for (var j = 0; j < student_cycles.length; j++) {
            if (student_cycles[j]["ID"] === active_cycle) {
                student_cycle = student_cycles[j];
                break;
            }
        }
        if (student_cycle) {
            grade = student_cycle["AvGrade"];
            va = student_cycle["AvVA"];
            grade = isNaN(parseFloat(grade)) ? "-" : precisionRound(grade, 1);
            va = isNaN(parseFloat(va)) ? "-" : precisionRound(va, 1);
        }
        var col_text = "var(--dark-grey)";
        if (va !== "-") {
            var colour = getColourForValue(va, 1.0, 0.1, -0.6, [60, 250, 0], [247, 153, 2], [210, 0, 0]);
            col_text = "rgb(" + colour[0] + ", " + colour[1] + ", " + colour[2] + ")";
        }
        table_array.push({
            "ID": id,
            "Name": name,
            "Surname": full_tutor_array[i]["Surname"],
            "Baseline": baseline,
            "Grade": grade,
            "Colour": col_text,
            "VA": va
        });
    }
    /* Order array */
    table_array = orderArrayBy(table_array, order_key, order_desc);
    for (var i = 0; i < table_array.length; i++) {
        var row = table_array[i];
        html_text += "<div class='content_row row ";
        html_text += i % 2 === 0 ? "even" : "odd";
        html_text += "' onclick='clickStudent(" + row["ID"] + ")'><div class='fill_col col left'><h4>" + row["Name"] + "</h4></div>";
        html_text += "<div class='fixed_col col'><h3>" + row["Baseline"] + "</h3></div><div class='fixed_col col'><h3>" + row["Grade"] + "</h3></div>";
        html_text += "<div class='fixed_col col' style='color:" + row["Colour"] + "'><h3>" + row["VA"] + "</h3></div></div>";
    }
    $("#student_average_table").html(html_text);
}

function writeStudentSubjectsTable() {
    for (var i = 0; i < full_tutor_array.length; i++) {
        if (full_tutor_array[i]["ID"] === active_student) {
            var student_cycles = full_tutor_array[i]["Cycles"];
            for (var j = 0; j < student_cycles.length; j++) {
                if (student_cycles[j]["ID"] === active_cycle) {
                    var student_cycle = student_cycles[j];
                    break;
                }
            }
            break;
        }
    }
    var subjects_array = student_cycle["Subjects"];
    var order_key = "Subject";
    var order_desc = true;
    if(student_subject_order[0]) {
        order_key = student_subject_order[0];
        order_desc = student_subject_order[1];
    }
    subjects_array = orderArrayBy(subjects_array, order_key, order_desc);
    var col_1 = order_key === "Subject" ? order_desc ? "Subject &darr;" : "Subject &uarr;" : "Subject";
    var col_2 = order_key === "Baseline" ? order_desc ? "Baseline &darr;" : "Baseline &uarr;" : "Baseline";
    var col_3 = order_key === "GradeVal" ? order_desc ? "Grade &darr;" : "Grade &uarr;" : "Grade";
    var col_4 = order_key === "VA" ? order_desc ? "VA &darr;" : "VA &uarr;" : "VA";
    var html_text = "<div class='header_row row'><div class='fill_col col left' onclick=clickHeader(\'Subject\',1)><h3>" + col_1 + "</h3></div>";
    html_text += "<div class='fixed_col col' onclick=clickHeader(\'Baseline\',1)><h3>" + col_2 + "</h3></div>"
    html_text += "<div class='fixed_col col' onclick=clickHeader(\'GradeVal\',1)><h3>" + col_3 + "</h3></div>";
    html_text += "<div class='fixed_col col' onclick=clickHeader(\'VA\',1)><h3>" + col_4 + "</h3></div></div>";
    for (var i = 0; i < subjects_array.length; i++) {
        var subject_name = subjects_array[i]["Subject"];
        var baseline = subjects_array[i]["Baseline"];
        baseline = isNaN(parseFloat(baseline)) ? "-" : baseline;
        var grade = subjects_array[i]["Grade"];
        var va = subjects_array[i]["VA"];
        var col_text = "var(--dark-grey)";
        if (!isNaN(parseFloat(va))) {
            va = precisionRound(va, 1);
            var colour = getColourForValue(va, 1.0, 0.1, -0.6, [60, 250, 0], [247, 153, 2], [210, 0, 0]);
            col_text = "rgb(" + colour[0] + ", " + colour[1] + ", " + colour[2] + ")";
        } else {
            va = "-";
        }
        html_text += "<div class='content_row row ";
        html_text += i % 2 === 0 ? "even" : "odd";
        html_text += "'><div class='fill_col col left'><h4>" + subject_name + "</h4></div>";
        html_text += "<div class='fixed_col col'><h3>" + baseline + "</h3></div><div class='fixed_col col'><h3>" + grade + "</h3></div>";
        html_text += "<div class='fixed_col col' style='color:" + col_text + "'><h3>" + va + "</h3></div></div>";
    }
    $("#student_subjects_table").html(html_text);
}

function updateActiveCycleButton() {
    var div = document.getElementById("cycle_buttons");
    var buttons = div.children;
    for (var i = 0; i < buttons.length; i++) {
        var id = buttons[i].id;
        $("#" + id).removeClass("active");
        if (id === "cycle_button_" + active_cycle) {
            $("#" + id).addClass("active");
        }
    }
}

function clickCycleButton(cycle) {
    if (cycle !== active_cycle) {
        active_cycle = cycle;
        setUpPage();
    }
}

function clickStudent(student) {
    current_view = "TRACKER";
    active_student = student;
    setUpPage();
}

function clickHeader(key, table) {
    switch (table) {
        case 0:
        default:
            if (student_average_order[0] === key) {
                student_average_order[1] = !student_average_order[1];
            } else {
                student_average_order[0] = key;
                student_average_order[1] = false;
            }
            break;
        case 1:
            if (student_subject_order[0] === key) {
                student_subject_order[1] = !student_subject_order[1];
            } else {
                student_subject_order[0] = key;
                student_subject_order[1] = false;
            }
            break;
    }

    setUpPage();
}

function clickTrackerOption(option_key) {
    for (var i = 0; i < tracker_options.length; i++) {
        if (tracker_options[i][2] === option_key) {
            tracker_options[i][1] = !tracker_options[i][1];
        }
    }
    updateTrackerOptions();
    updateTrackerDatasets();
}

function getStudentName(student) {
    for (var j = 0; j < full_tutor_array.length; j++) {
        if (full_tutor_array[j]["ID"] === student) {
            return full_tutor_array[j]["Name"] + " " + full_tutor_array[j]["Surname"];
        }
    }
    return "-";
}

function adjustTrackerSize() {
    var offset = $("#student_tracker_div").offset();
    var available_height = $(window).height() - offset["top"] - 60;
    var height = Math.min(Math.max(available_height, 400),800);
    var options_height = height + "px";

    var available_width = $("#student_tracker").width();
    var options_width = 200;
    var width = available_width - options_width - 70;

    var options_margin_left = 0;
    var options_margin_top = 10;

    if (width < 600) {
        /* 2 level */
        width = available_width - 40;
        options_width = available_width - 40;
        options_margin_left = 10;
        options_margin_top = 0;
        options_height = "auto";
    } else if (width >= 700 && width < 800) {
        options_width = 250;
        width = available_width - options_width - 70;
    } else if (width >= 800 && width < 1000) {
        options_width = 300;
        width = available_width - options_width - 70;
    } else if (width >= 1000){
        width = 1000;
        options_width = available_width - width - 70;
    }

    $("#student_tracker_div").css("width", width + "px");
    $("#student_tracker_div").css("height", height + "px");
    $("#student_tracker_options").css("height", options_height);
    $("#student_tracker_options").css("width", options_width + "px");
    $("#student_tracker_options").css("margin-left", options_margin_left + "px");
    $("#student_tracker_options").css("margin-top", options_margin_top + "px");
}

function setUpStudentButtons() {
    /* Back button */
    var html_text = "<div class='button left' onclick='backToSummary()'><div class='button_logo'></div><span><h4>" + page_title + "</h4></span></div>";
    for (var i = 0; i < full_tutor_array.length; i++) {
        if (full_tutor_array[i]["ID"] === active_student) {
            var prev_student_array_val = i - 1;
            var next_student_array_val = i + 1;
            if (i === 0) {
                prev_student_array_val = full_tutor_array.length - 1;
            }
            if (i === full_tutor_array.length - 1) {
                next_student_array_val = 0;
            }
            break;
        }
    }
    /* Next student buttons */
    var next_student_id = full_tutor_array[next_student_array_val]["ID"];
    var next_student_name = full_tutor_array[next_student_array_val]["Name"] + " " + full_tutor_array[next_student_array_val]["Surname"];
    var prev_student_id = full_tutor_array[prev_student_array_val]["ID"];
    var prev_student_name = full_tutor_array[prev_student_array_val]["Name"] + " " + full_tutor_array[prev_student_array_val]["Surname"];
    html_text += "<div class='button right double_right' onclick='changeStudent(" + next_student_id + ")'><span><h4>" + next_student_name + "</h4></span><div class='button_logo right'></div></div>";
    html_text += "<div class='button right double' onclick='changeStudent(" + prev_student_id + ")'><div class='button_logo'></div><span><h4>" + prev_student_name + "</h4></span></div>";
    $("#top_buttons").html(html_text);
    /* Tracker and subjects buttons */
    html_text = "<div class='primary_section_button' id='student_tracker_button' onclick='clickStudentTrackerButton()'><h3>Tracker</h3></div>";
    html_text += "<div class='primary_section_button last' id='student_subjects_button' onclick='clickStudentSubjectsButton()'><h3>Subjects</h3></div>";
    $("#student_tabs").html(html_text);
    if (current_view === "TRACKER") {
        $("#student_tracker_button").addClass("active");
        $("#student_subjects_button").removeClass("active");
    } else {
        $("#student_tracker_button").removeClass("active");
        $("#student_subjects_button").addClass("active");
    }
}

function writeStudentTrackerOptions() {
    var html_text = "";
    for (var i = 0; i < tracker_options.length; i++) {
        var display_name = tracker_options[i][0];
        var display = tracker_options[i][1];
        var id_name = tracker_options[i][2];
        html_text += "<div class='primary_section_chart_option' onclick='clickTrackerOption(\"" + id_name + "\")'>";
        html_text += "<span id='checkmark_" + id_name + "' class='checkmark"
        html_text += "'></span><span><h3>" + display_name + "</h3></span></div>";
    }
    $("#student_tracker_options").html(html_text);
    updateTrackerOptions();
}

function updateTrackerOptions() {
    for (var i = 0; i < tracker_options.length; i++) {
        if (tracker_options[i][1]) {
            $("#checkmark_" + tracker_options[i][2]).addClass("checked");
        } else {
            $("#checkmark_" + tracker_options[i][2]).removeClass("checked");
        }
    }
}

function writeStudentTracker() {
    $("#student_tracker_div").html("<canvas id='student_tracker_canvas'></canvas></div>");

    adjustTrackerSize();
    var name = getStudentName(active_student);

    var labels = [];
    var va_data = [];
    var target_data = [];
    var year_data = [];
    var max_val = -1000;
    var min_val = 1000;
    for (var i = 0; i < cycles.length; i++) {
        labels.push(cycles[i]["Name"]);
        var cycle_id = cycles[i]["ID"];
        for (var j = 0; j < full_tutor_array.length; j++) {
            if (full_tutor_array[j]["ID"] === active_student) {
                var student_cycles = full_tutor_array[j]["Cycles"];
                var va = false;
                var avg_va = false;
                for (var k = 0; k < student_cycles.length; k++) {
                    if (student_cycles[k]["ID"] === cycle_id) {
                        va = precisionRound(student_cycles[k]["AvVA"],2);
                        max_val = Math.max(max_val, va);
                        min_val = Math.min(min_val, va);
                        break;
                    }
                }
                for (var l = 0; l < yeargroup_average.length; l++) {
                    if (yeargroup_average[l]["Cycle"] === cycle_id) {
                        avg_va = precisionRound(yeargroup_average[l]["VA"],2);
                        max_val = Math.max(max_val, avg_va);
                        min_val = Math.min(min_val, avg_va);
                        break;
                    }
                }
                va_data.push(va ? va : "");
                year_data.push(avg_va ? avg_va : "");
                max_val = Math.max(max_val, target_va);
                min_val = Math.min(min_val, target_va);
                target_data.push(target_va);
                break;
            }
        }
    }
    max_val = precisionRound(max_val + 0.2, 1);
    min_val = precisionRound(min_val - 0.2, 1);
    var datasets = [];
    for (var i = 0; i < tracker_options.length; i++) {
        var option = tracker_options[i];
        var data_array = {
            borderWidth: 2,
            fill: false,
            lineTension: 0,
            spanGaps: true,
            label: option[0]
        };
        switch (option[2]) {
            case "Tracker":
                data_array["data"] = va_data;
                data_array["borderColor"] = "#f49712";
                data_array["pointBackgroundColor"] = "#f49712";
                data_array["showLine"] = option[1];
                data_array["pointRadius"] = option[1] ? 2 : 0;
                data_array["pointHoverRadius"] = option[1] ? 2 : 0;
                datasets.push(data_array);
                break;
            case "TargetVA":
                data_array["data"] = target_data;
                data_array["borderColor"] = "#f7d117";
                data_array["pointBackgroundColor"] = "#f7d117";
                data_array["showLine"] = option[1];
                data_array["pointRadius"] = option[1] ? 2 : 0;
                data_array["pointHoverRadius"] = option[1] ? 2 : 0;
                datasets.push(data_array);
                break;
            case "YearAvg":
                data_array["data"] = year_data;
                data_array["borderColor"] = "#353d47";
                data_array["pointBackgroundColor"] = "#353d47";
                data_array["showLine"] = option[1];
                data_array["pointRadius"] = option[1] ? 2 : 0;
                data_array["pointHoverRadius"] = option[1] ? 2 : 0;
                datasets.push(data_array);
                break;
        }
    }
    tracker_chart = new Chart(document.getElementById("student_tracker_canvas"), {
        type: 'line',
        data: {
        labels: labels,
        datasets: datasets
        },
        options: {
            responsive:true,
            maintainAspectRatio: false,
            legend: {
                position: 'bottom',
            },
            scales: {
                xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Reporting Cycle'
                        }
                    }],
                yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'VA'
                        },
                        ticks: {
                            min: min_val,
                            max: max_val
                        }
                    }]
            },
            layout: {
                padding: {
                    left: 10,
                    right: 10,
                    top: 10,
                    bottom: 10
                }
            }
        }
    });

    adjustTrackerSize();
    tracker_chart.render();
}

function updateTrackerDatasets() {
    for (var i = 0; i < tracker_options.length; i++) {
        var option = tracker_options[i];
        switch (option[2]) {
            case "Tracker":
                if (option[1]) {
                    tracker_chart.data.datasets[0].showLine = true;
                    tracker_chart.data.datasets[0].pointRadius = 2;
                    tracker_chart.data.datasets[0].pointHoverRadius = 2;
                } else {
                    tracker_chart.data.datasets[0].showLine = false;
                    tracker_chart.data.datasets[0].pointRadius = 0;
                    tracker_chart.data.datasets[0].pointHoverRadius = 0;
                }
                break;
            case "TargetVA":
                if (option[1]) {
                    tracker_chart.data.datasets[1].showLine = true;
                    tracker_chart.data.datasets[1].pointRadius = 1;
                    tracker_chart.data.datasets[1].pointHoverRadius = 1;
                } else {
                    tracker_chart.data.datasets[1].showLine = false;
                    tracker_chart.data.datasets[1].pointRadius = 0;
                    tracker_chart.data.datasets[1].pointHoverRadius = 0;
                }
                break;
            case "YearAvg":
                if (option[1]) {
                    tracker_chart.data.datasets[2].showLine = true;
                    tracker_chart.data.datasets[2].pointRadius = 1;
                    tracker_chart.data.datasets[2].pointHoverRadius = 1;
                } else {
                    tracker_chart.data.datasets[2].showLine = false;
                    tracker_chart.data.datasets[2].pointRadius = 0;
                    tracker_chart.data.datasets[2].pointHoverRadius = 0;
                }
                break;
        }
    }
    tracker_chart.update();
}
