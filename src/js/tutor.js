var reports = "[{\"Student\":1,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":1,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":8},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":1,\"Cycle\":5,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Photography\",\"Grade\":7},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":5,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":5,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":7},{\"Student\":2,\"Cycle\":5,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Mandarin\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":2,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":\"\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Mandarin\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":3,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Latin\",\"Grade\":8},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":5,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":5,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Latin\",\"Grade\":7},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":5,\"Subject\":\"RS\",\"Grade\":\"-\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":5,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":1,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":6},{\"Student\":1,\"Cycle\":4,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Photography\",\"Grade\":8},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":4,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":4,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":6},{\"Student\":2,\"Cycle\":4,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Mandarin\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":2,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":3,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":8},{\"Student\":3,\"Cycle\":4,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":4,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":3,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":4,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":4,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":4,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":4,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Latin\",\"Grade\":8},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":4,\"Subject\":\"RS\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":4,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Drama\",\"Grade\":6},{\"Student\":1,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":5},{\"Student\":1,\"Cycle\":3,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Photography\",\"Grade\":8},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":1,\"Cycle\":3,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Computer Science\",\"Grade\":7},{\"Student\":2,\"Cycle\":3,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":6},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Geography\",\"Grade\":5},{\"Student\":2,\"Cycle\":3,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Mandarin\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":2,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":3,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":8},{\"Student\":3,\"Cycle\":3,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":3,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":3,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":4,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":3,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":3,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":3,\"Subject\":\"French\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":3,\"Subject\":\"RS\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":3,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":1,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":6},{\"Student\":1,\"Cycle\":2,\"Subject\":\"PE\",\"Grade\":8},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Photography\",\"Grade\":8},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":2,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":2,\"Subject\":\"DT\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":7},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":2,\"Cycle\":2,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Mandarin\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":2,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Drama\",\"Grade\":5},{\"Student\":3,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":8},{\"Student\":3,\"Cycle\":2,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":2,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":3,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Drama\",\"Grade\":6},{\"Student\":4,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":2,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":2,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"English\",\"Grade\":8},{\"Student\":5,\"Cycle\":2,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":2,\"Subject\":\"RS\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":2,\"Subject\":\"Spanish\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"B\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Drama\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":6},{\"Student\":1,\"Cycle\":1,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Photography\",\"Grade\":7},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":1,\"Cycle\":1,\"Subject\":\"Spanish\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Computer Science\",\"Grade\":6},{\"Student\":2,\"Cycle\":1,\"Subject\":\"DT\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":6},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Geography\",\"Grade\":7},{\"Student\":2,\"Cycle\":1,\"Subject\":\"History\",\"Grade\":\"B\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Mandarin\",\"Grade\":\"A*\"},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":2,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":3,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":7},{\"Student\":3,\"Cycle\":1,\"Subject\":\"History\",\"Grade\":\"A\"},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Mandarin\",\"Grade\":6},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":3,\"Cycle\":1,\"Subject\":\"PE\",\"Grade\":6},{\"Student\":3,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Drama\",\"Grade\":8},{\"Student\":4,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":8},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Geography\",\"Grade\":6},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Latin\",\"Grade\":6},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":7},{\"Student\":4,\"Cycle\":1,\"Subject\":\"PE\",\"Grade\":7},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":4,\"Cycle\":1,\"Subject\":\"Spanish\",\"Grade\":\"A\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Biology\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Chemistry\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"English\",\"Grade\":7},{\"Student\":5,\"Cycle\":1,\"Subject\":\"French\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"History\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Latin\",\"Grade\":7},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Maths\",\"Grade\":8},{\"Student\":5,\"Cycle\":1,\"Subject\":\"RS\",\"Grade\":\"B\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Physics\",\"Grade\":\"A*\"},{\"Student\":5,\"Cycle\":1,\"Subject\":\"Spanish\",\"Grade\":\"A*\"}]";

var cycles = "[{\"ID\":1,\"Name\":\"Mich 1\",\"Date\":\"20-Oct-17\"},{\"ID\":2,\"Name\":\"Mich 2\",\"Date\":\"01-Dec-17\"},{\"ID\":3,\"Name\":\"Lent 1\",\"Date\":\"20-Feb-18\"},{\"ID\":4,\"Name\":\"Lent 2\",\"Date\":\"01-Apr-18\"},{\"ID\":5,\"Name\":\"Summer 1\",\"Date\":\"01-May-18\"}]";

var baselines = "[{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Biology\",\"Baseline\":\"-\"},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Chemistry\",\"Baseline\":6.7},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Drama\",\"Baseline\":6.4},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"English\",\"Baseline\":6.3},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Geography\",\"Baseline\":6.4},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Maths\",\"Baseline\":6.6},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"PE\",\"Baseline\":6.2},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Photography\",\"Baseline\":6.4},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Physics\",\"Baseline\":6.7},{\"ID\":1,\"Name\":\"Jonah\",\"Surname\":\"Bates\",\"Subject\":\"Spanish\",\"Baseline\":6.3},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Biology\",\"Baseline\":7.5},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Chemistry\",\"Baseline\":7.5},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Computer Science\",\"Baseline\":6.9},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"DT\",\"Baseline\":7.4},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"English\",\"Baseline\":7.5},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"History\",\"Baseline\":7.7},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Mandarin\",\"Baseline\":7.07},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Maths\",\"Baseline\":8},{\"ID\":2,\"Name\":\"Lucian\",\"Surname\":\"Bennett\",\"Subject\":\"Physics\",\"Baseline\":7.6},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Biology\",\"Baseline\":7},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Chemistry\",\"Baseline\":6.9},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Drama\",\"Baseline\":6.7},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"English\",\"Baseline\":6.6},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"History\",\"Baseline\":6.8},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Mandarin\",\"Baseline\":6.47},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Maths\",\"Baseline\":7},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"PE\",\"Baseline\":6.5},{\"ID\":3,\"Name\":\"Oscar\",\"Surname\":\"Heal\",\"Subject\":\"Physics\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Biology\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Chemistry\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Drama\",\"Baseline\":6.7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"English\",\"Baseline\":6.7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Geography\",\"Baseline\":6.8},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Latin\",\"Baseline\":6.67},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Maths\",\"Baseline\":7.1},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"PE\",\"Baseline\":6.5},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Physics\",\"Baseline\":7},{\"ID\":4,\"Name\":\"Raghuv\",\"Surname\":\"Kanwar\",\"Subject\":\"Spanish\",\"Baseline\":6.7},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Biology\",\"Baseline\":7.1},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Chemistry\",\"Baseline\":7.1},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"English\",\"Baseline\":6.9},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"French\",\"Baseline\":6.8},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"History\",\"Baseline\":7},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Latin\",\"Baseline\":6.77},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Maths\",\"Baseline\":7.3},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"RS\",\"Baseline\":7.1},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Physics\",\"Baseline\":6.9},{\"ID\":5,\"Name\":\"Zayn\",\"Surname\":\"Rajan\",\"Subject\":\"Spanish\",\"Baseline\":6.9}]";

/* Globals */
var active_cycle;
var current_view;
var active_student;

//var students;
var full_tutor_array;
var page_title;

$(document).ready(function(){
    baselines = JSON.parse(baselines);
    cycles = JSON.parse(cycles);
    reports = JSON.parse(reports);
    full_tutor_array = generateFullTutorArray(reports, cycles, baselines);
    //students = getStudentsWithAvgBaselines(baselines);
    cycles = orderArrayByDate(cycles, "Date", "DD-MMM-YY", false);
    page_title = "Murray 5th Form";
    /* Set up view */
    active_cycle = cycles[cycles.length - 1]["ID"];
    current_view = "SUMMARY";
    active_student = null;

    /* setUpPage */
    setUpPage();
});

$(window).resize(function() {
    adjustTrackerSize();
});

function setUpPage() {
    hideAllViews();
    switch(current_view) {
        case "SUMMARY":
        default:
            showSummaryView();
            $("#main_title").html("<h1>" + page_title + "</h1>");
            writeCycleButtons();
            /* TODO update */
            writeStudentAverageTable();
            break;
        case "TRACKER":
            showStudentTrackerView();
            $("#main_title").html("<h1>" + getStudentName(active_student) + "</h1>");
            setUpStudentButtons();
            writeStudentTrackerOptions();
            writeStudentTracker();
            break;
        case "SUBJECTS":
            showStudentSubjectView();
            $("#main_title").html("<h1>" + getStudentName(active_student) + "</h1>");
            writeCycleButtons();
            setUpStudentButtons();
            writeStudentSubjectsTable();
            break;
    }
}

/* Show/hide all views */

function hideAllViews() {
    $("#cycle_buttons").css("display", "none");
    $("#student_average_table").css("display", "none");
    $("#student_tracker").css("display", "none");
    $("#student_tabs").css("display", "none");
    $("#student_subjects_table").css("display", "none");
    $("#top_buttons").css("display", "none");
}

function showSummaryView() {
    $("#cycle_buttons").css("display", "inline-block");
    $("#student_average_table").css("display", "inline-block");
    $(".primary_section").removeClass("orange");
    $(".primary_section").removeClass("tracker");
}

function showStudentTrackerView() {
    $("#student_tracker").css("display", "inline-block");
    $("#student_tabs").css("display", "inline-block");
    $(".primary_section").addClass("orange");
    $(".primary_section").addClass("tracker");
    $("#top_buttons").css("display", "inline-block");
    $("#student_tracker_button").addClass("active");
    $("#student_subjects_button").removeClass("active");
}

function showStudentSubjectView() {
    $("#student_tabs").css("display", "inline-block");
    $("#cycle_buttons").css("display", "inline-block");
    $("#student_subjects_table").css("display", "inline-block");
    $(".primary_section").addClass("orange");
    $(".primary_section").addClass("tracker");
    $("#top_buttons").css("display", "inline-block");
    $("#student_tracker_button").removeClass("active");
    $("#student_subjects_button").addClass("active");
}


function clickStudentTrackerButton() {
    current_view = "TRACKER";
    setUpPage();
}

function clickStudentSubjectsButton() {
    current_view = "SUBJECTS";
    setUpPage();
}

function changeStudent(student) {
    active_student = student;
    setUpPage();
}

function backToSummary() {
    current_view = "SUMMARY";
    setUpPage();
}

function writeCycleButtons() {
    var html_text = "";
    for (var i = 0; i < cycles.length; i++) {
        var title = cycles[i]["Name"];
        var id = cycles[i]["ID"];
        var class_text = "primary_section_button";
        if (id === active_cycle) class_text += " active";
        if (i === cycles.length - 1) class_text += " last";
        html_text += "<div class='" + class_text + "' id='cycle_button_" + id + "' onclick='clickCycleButton(" + id + ")'><h4>" + title + "</h4></div>";
    }
    $("#cycle_buttons").html(html_text);
}

function writeStudentAverageTable(students) {
    /* Order by surname */
    full_tutor_array = orderArrayBy(full_tutor_array, "Surname", false);
    /* Header row */
    var html_text = "<div class='header_row row'><div class='fill_col col left'><h3>Student</h3></div>";
    html_text += "<div class='fixed_col col'><h3>Baseline</h3></div><div class='fixed_col col'><h3>Grade</h3></div>";
    html_text += "<div class='fixed_col col'><h3>VA</h3></div></div>";
    for (var i = 0; i < full_tutor_array.length; i++) {
        var id = full_tutor_array[i]["ID"];
        var name = full_tutor_array[i]["Name"] + " " + full_tutor_array[i]["Surname"];
        var baseline = full_tutor_array[i]["AvBaseline"];
        baseline = isNaN(parseFloat(baseline)) ? "-" : precisionRound(baseline, 1);
        var student_cycles = full_tutor_array[i]["Cycles"];
        var student_cycle = false;
        var grade = "-";
        var va = "-";
        for (var j = 0; j < student_cycles.length; j++) {
            if (student_cycles[j]["ID"] === active_cycle) {
                student_cycle = student_cycles[j];
                break;
            }
        }
        if (student_cycle) {
            grade = student_cycle["AvGrade"];
            va = student_cycle["AvVA"];
            grade = isNaN(parseFloat(grade)) ? "-" : precisionRound(grade, 1);
            va = isNaN(parseFloat(va)) ? "-" : precisionRound(va, 1);
        }
        var col_text = "var(--dark-grey)";
        if (va !== "-") {
            var colour = getColourForValue(va, 1.0, 0.1, -0.6, [60, 250, 0], [247, 153, 2], [210, 0, 0]);
            col_text = "rgb(" + colour[0] + ", " + colour[1] + ", " + colour[2] + ")";
        }
        html_text += "<div class='content_row row ";
        html_text += i % 2 === 0 ? "even" : "odd";
        html_text += "' onclick='clickStudent(" + id + ")'><div class='fill_col col left'><h4>" + name + "</h4></div>";
        html_text += "<div class='fixed_col col'><h3>" + baseline + "</h3></div><div class='fixed_col col'><h3>" + grade + "</h3></div>";
        html_text += "<div class='fixed_col col' style='color:" + col_text + "'><h3>" + va + "</h3></div></div>";
    }
    $("#student_average_table").html(html_text);
}

function writeStudentSubjectsTable() {
    for (var i = 0; i < full_tutor_array.length; i++) {
        if (full_tutor_array[i]["ID"] === active_student) {
            var student_cycles = full_tutor_array[i]["Cycles"];
            for (var j = 0; j < student_cycles.length; j++) {
                if (student_cycles[j]["ID"] === active_cycle) {
                    var student_cycle = student_cycles[j];
                    break;
                }
            }
            break;
        }
    }
    var subjects_array = student_cycle["Subjects"];
    var html_text = "<div class='header_row row'><div class='fill_col col left'><h3>Subject</h3></div>";
    html_text += "<div class='fixed_col col'><h3>Baseline</h3></div><div class='fixed_col col'><h3>Grade</h3></div>";
    html_text += "<div class='fixed_col col'><h3>VA</h3></div></div>";
    var i = 0;
    for (var key in subjects_array) {
        var subject_name = key;
        var baseline = subjects_array[key]["Baseline"];
        baseline = isNaN(parseFloat(baseline)) ? "-" : baseline;
        var grade = subjects_array[key]["Grade"];
        var va = subjects_array[key]["VA"];
        var col_text = "var(--dark-grey)";
        if (!isNaN(parseFloat(va))) {
            va = precisionRound(va, 1);
            var colour = getColourForValue(va, 1.0, 0.1, -0.6, [60, 250, 0], [247, 153, 2], [210, 0, 0]);
            col_text = "rgb(" + colour[0] + ", " + colour[1] + ", " + colour[2] + ")";
        } else {
            va = "-";
        }
        html_text += "<div class='content_row row ";
        html_text += i % 2 === 0 ? "even" : "odd";
        html_text += "'><div class='fill_col col left'><h4>" + subject_name + "</h4></div>";
        html_text += "<div class='fixed_col col'><h3>" + baseline + "</h3></div><div class='fixed_col col'><h3>" + grade + "</h3></div>";
        html_text += "<div class='fixed_col col' style='color:" + col_text + "'><h3>" + va + "</h3></div></div>";
        i++;
    }
    $("#student_subjects_table").html(html_text);
}

function updateActiveCycleButton() {
    var div = document.getElementById("cycle_buttons");
    var buttons = div.children;
    for (var i = 0; i < buttons.length; i++) {
        var id = buttons[i].id;
        $("#" + id).removeClass("active");
        if (id === "cycle_button_" + active_cycle) {
            $("#" + id).addClass("active");
        }
    }
}

function clickCycleButton(cycle) {
    if (cycle !== active_cycle) {
        active_cycle = cycle;
        setUpPage();
    }
}

function clickStudent(student) {
    current_view = "TRACKER";
    active_student = student;
    setUpPage();
}

function getStudentName(student) {
    for (var j = 0; j < full_tutor_array.length; j++) {
        if (full_tutor_array[j]["ID"] === student) {
            return full_tutor_array[j]["Name"] + " " + full_tutor_array[j]["Surname"];
        }
    }
    return "-";
}

function adjustTrackerSize() {
    var offset = $("#student_tracker_div").offset();
    var available_height = $(window).height() - offset["top"] - 60;
    var height = Math.min(Math.max(available_height, 400),800);
    var options_height = height + "px";

    var available_width = $("#student_tracker").width();
    var options_width = 200;
    var width = available_width - options_width - 70;

    var options_margin_left = 0;
    var options_margin_top = 10;

    if (width < 600) {
        /* 2 level */
        width = available_width - 40;
        options_width = available_width - 40;
        options_margin_left = 10;
        options_margin_top = 0;
        options_height = "auto";
    } else if (width >= 700 && width < 800) {
        options_width = 250;
        width = available_width - options_width - 70;
    } else if (width >= 800 && width < 1000) {
        options_width = 300;
        width = available_width - options_width - 70;
    } else if (width >= 1000){
        width = 1000;
        options_width = available_width - width - 70;
    }

    $("#student_tracker_div").css("width", width + "px");
    $("#student_tracker_div").css("height", height + "px");
    $("#student_tracker_options").css("height", options_height);
    $("#student_tracker_options").css("width", options_width + "px");
    $("#student_tracker_options").css("margin-left", options_margin_left + "px");
    $("#student_tracker_options").css("margin-top", options_margin_top + "px");
}

function setUpStudentButtons() {
    /* Back button */
    var html_text = "<div class='button left' onclick='backToSummary()'><div class='button_logo'></div><span><h4>" + page_title + "</h4></span></div>";
    for (var i = 0; i < full_tutor_array.length; i++) {
        if (full_tutor_array[i]["ID"] === active_student) {
            var prev_student_array_val = i - 1;
            var next_student_array_val = i + 1;
            if (i === 0) {
                prev_student_array_val = full_tutor_array.length - 1;
            }
            if (i === full_tutor_array.length - 1) {
                next_student_array_val = 0;
            }
            break;
        }
    }
    /* Next student buttons */
    var next_student_id = full_tutor_array[next_student_array_val]["ID"];
    var next_student_name = full_tutor_array[next_student_array_val]["Name"] + " " + full_tutor_array[next_student_array_val]["Surname"];
    var prev_student_id = full_tutor_array[prev_student_array_val]["ID"];
    var prev_student_name = full_tutor_array[prev_student_array_val]["Name"] + " " + full_tutor_array[prev_student_array_val]["Surname"];
    html_text += "<div class='button right double_right' onclick='changeStudent(" + next_student_id + ")'><span><h4>" + next_student_name + "</h4></span><div class='button_logo right'></div></div>";
    html_text += "<div class='button right double' onclick='changeStudent(" + prev_student_id + ")'><div class='button_logo'></div><span><h4>" + prev_student_name + "</h4></span></div>";
    $("#top_buttons").html(html_text);
    /* Tracker and subjects buttons */
    html_text = "<div class='primary_section_button' id='student_tracker_button' onclick='clickStudentTrackerButton()'><h3>Tracker</h3></div>";
    html_text += "<div class='primary_section_button last' id='student_subjects_button' onclick='clickStudentSubjectsButton()'><h3>Subjects</h3></div>";
    $("#student_tabs").html(html_text);
    if (current_view === "TRACKER") {
        $("#student_tracker_button").addClass("active");
        $("#student_subjects_button").removeClass("active");
    } else {
        $("#student_tracker_button").removeClass("active");
        $("#student_subjects_button").addClass("active");
    }
}

function writeStudentTrackerOptions() {
    var html_text = "";
    var options = [["Tracker", true], ["Target VA", false], ["Year Avg", false]];
    for (var i = 0; i < options.length; i++) {
        var name = options[i][0];
        var display = options[i][1];
        html_text += "<div class='primary_section_chart_option'>";
        html_text += "<input type='checkbox' class='primary_section_chart_option_check'";
        if (display) html_text += " checked='checked'";
        html_text += "'><span class='checkmark'></span><span><h3>" + name + "</h3></span></div>";
    }
    $("#student_tracker_options").html(html_text);
}
function writeStudentTracker() {
    $("#student_tracker_div").html("<canvas id='student_tracker_canvas'></canvas></div>");

    adjustTrackerSize();

    var labels = [];
    var va_data = [];
    var target_data = [];
    var max_val = -1000;
    var min_val = 1000;
    for (var i = 0; i < cycles.length; i++) {
        labels.push(cycles[i]["Name"]);
        var cycle_id = cycles[i]["ID"];
        for (var j = 0; j < full_tutor_array.length; j++) {
            if (full_tutor_array[j]["ID"] === active_student) {
                var student_cycles = full_tutor_array[j]["Cycles"];
                var va = false;
                for (var k = 0; k < student_cycles.length; k++) {
                    if (student_cycles[k]["ID"] === cycle_id) {
                        va = precisionRound(student_cycles[k]["AvVA"],2);
                        max_val = Math.max(max_val, va);
                        min_val = Math.min(min_val, va);
                        break;
                    }
                }
                va_data.push(va ? va : "");
                max_val = Math.max(max_val, 0.6);
                min_val = Math.min(min_val, 0.6);
                target_data.push(0.6);
                break;
            }
        }
    }
    max_val = precisionRound(max_val + 0.2, 1);
    min_val = precisionRound(min_val - 0.2, 1);
    new Chart(document.getElementById("student_tracker_canvas"), {
        type: 'line',
        data: {
        labels: labels,
        datasets: [{
            data: va_data,
            label: "VA",
            borderColor: "#f49712",
            fill: false,
            lineTension: 0
          }]
        },
        options: {
            responsive:true,
            maintainAspectRatio: false,
            legend: {
                position: 'bottom',
            },
            scales: {
                xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Reporting Cycle'
                        }
                    }],
                yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'VA'
                        },
                        ticks: {
                            min: min_val,
                            max: max_val
                        }
                    }]
            },
            layout: {
                padding: {
                    left: 50,
                    right: 0,
                    top: 0,
                    bottom: 0
                }
            }
        }
    });
}
